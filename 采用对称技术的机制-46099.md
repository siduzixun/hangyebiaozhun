# 声明 
本文是学习[github5.com 网站的报告](https://siduwenku.com/view/list/report?f=first)而整理的学习笔记,分享出来希望更多人受益,如果存在侵权请及时联系我们
# 安全技术抗抵赖 安全信封  
  
安全信封是一种数据完整性校验方法，用于在共享一个秘密密钥的两个实体（该密钥仅为这两个实体所知）间来相互传递消息。SENV可以用于保护输入数据项，此时SENV使用实体的秘密密钥来产生；此外，SENV也可以用于生成和验证证据，此时SENV由TTP使用仅为TTP持有的秘密密钥来产生。  
  
对于要保护的数据y，实体X使用如下的基于对称密码技术的完整性技术来创建安全信封。其中，实体X的秘密密钥x用于计算密码校验值MACX(y)，并将该值附加在数据的后面，即：  
  
SENVX(y)=(y, MACX(y))  
  
在计算MACX(y)时，应使用满足GB/T 15852(所有部分)要求的消息鉴别码算法。  
  
1.  本文件规定的安全信封的强度依赖于所使用的密码学机制和参数的安全级别和强度，抗抵赖机制的使用者可根据实际业务的安全需求来选择适当的机制，GB/T 15852（所有部分）中给出了各种消息鉴别码机制安全性的说明。  
  
# 抗抵赖令牌的生成与验证  
  
**TTP创建令牌**   
  
在本章描述的抗抵赖机制中，TTP担当证据生成和证据验证机构的角色。TTP可信赖地维护特定记录的完整性并直接参与解决争议。  
  
对于要应用抗抵赖机制的消息m，TTP颁发与m相对应的“令牌”。令牌包括一个由TTP使用其秘密密钥ttp作用于该消息所确定的数据而形成的安全信封。因为其它实体都不知道TTP的秘密密钥ttp，所以TTP是唯一可以创建和验证令牌的实体。根据GB/T 17903.1中对通用抗抵赖令牌的定义和本文件描述的场景，本节中GNRT的定义如下：  
  
GNRT = (text, SENVTTP(y)) = (text,y,MACTTP(y))  
  
y表示安全信封中数据项，其具体内容见8.2，，其中包含与m相关的信息。此外，在发布令牌之前，TTP应检查证据请求中的数据项。  
  
1.  消息m可以是明文或密文。  
2.  text为文本域，包括一些不需要密码学保护但在计算完整性校验值MAC和安全信封SENV时要用到的，或用于标识消息和密钥的附加数据（如消息标识符或密钥标识符），text的内容可以与消息m无关。本信息的具体内容依赖于所使用的技术。  
  
抗抵赖机制使用的数据项  
  
**安全信封使用的数据项**   
  
在本文件描述的抗抵赖机制中，将对安全信封SENVX(zi)= (zi, MACX(zi))进行交换，下列数据字段构成了该安全信封的内容：  
  
zi = (Pol,fi,A,B,C,D,,TG,Ti,Q,Imp(m))  
  
数据域z中包含的数据项定义如下：  
  
Pol 适用于证据的抗抵赖策略的可区分标识符；  
  
fi 提供的抗抵赖服务的类型；  
  
A 原发实体的可区分标识符；  
  
B 与原发实体进行交互的实体的可区分标识符；  
  
C 证据生成者的可区分标识符；  
  
D 证据请求者的可区分标识符，如果证据请求者与原发实体不同；  
  
动作涉及到的其他实体的可区分标识符（的集合）；  
  
TG 证据生成的日期与时间；  
  
Ti 事件或动作发生的日期与时间；  
  
Q 需要保护的可选数据；  
  
Imp(m) 与动作有关的消息m的印记，即1）m的杂凑码，或2）m本身。  
  
1.  在本文件中，根据抗抵赖服务类型的不同，i的值为1（原发抗抵赖）或2（交付抗抵赖）。  
  
**抗抵赖令牌使用的数据项**   
  
在本文件描述的抗抵赖机制中，抗抵赖令牌NRT包括一个文本域text与一个安全信封，定义如下：  
  
NRT = (text, SENVTTP(y))  
  
1.  文本域包括一些不需要密码学保护但在计算完整性校验值MAC和安全信封SENV时要用到的，或用于标识消息和密钥的附加数据（如消息标识符或密钥标识符）。本信息的具体内容依赖于所使用的技术。  
  
抗抵赖令牌  
  
**证据提供**   
  
证据通常由抗抵赖令牌提供，如果策略要求，也可以由附加令牌提供，例如：时间戳令牌（TST）、或由另一个可信的第四方（如公证人）提供的对事件和动作以及消息的存在性给予附加保证的令牌等。  
  
如果可信第三方可以独自生成可信时间戳，则不需要增加TST作为证据。  
  
1.  抗抵赖令牌（NROT、NRDT）中包含的时间可认为是安全可靠的，因为它是由可信机构提供的。  
2.  如果可信第三方（TTP、DA）不能提供可信时间戳，那么抗抵赖集合中就需要增加由可信时间戳机构（TSA）提供的TST以完成证据。  
  
**原发抗抵赖令牌**   
  
原发抗抵赖令牌（NROT）由TTP应原发者的请求而创建，其格式如下：  
  
NROT = (text,z1,MACTTP(z1))，其中  
  
z1 = (Pol,f1,A,B,C,D,TG,T1,Q,Imp(m))  
  
NROT所需信息z1中包含的数据项定义如下：  
  
Pol 适用于证据的抗抵赖策略的可区分标识符；  
  
f1 原发抗抵赖服务的标记；  
  
A 原发者的可区分标识符；  
  
B 预定接收者的可区分标识符；  
  
C 生成证据的TTP的可区分标识符；  
  
D 观察者的可区分标识符，如果存在独立观察者；  
  
TG 证据生成的日期与时间；  
  
T1 消息原发的日期与时间；  
  
Q 需要保护的可选数据；  
  
Imp(m) 与动作有关的消息m的印记，即1）m的杂凑码，或2）m本身。  
  
**交付抗抵赖令牌**   
  
交付抗抵赖令牌（NRDT）由TTP应接收者的请求而创建，其格式如下：  
  
NRDT = (text,z2,MACTTP(z2))，其中  
  
z2 = (Pol,f2,A,B,C,D,TG,T2,Q,Imp(m))  
  
NRDT所需信息z2中包含的数据项定义如下：  
  
Pol 适用于证据的抗抵赖策略的可区分标识符；  
  
f2 交付抗抵赖服务的标记；  
  
A 原发者的可区分标识符；  
  
B 接收者的可区分标识符；  
  
C TTP的可区分标识符；  
  
D 观察者的可区分标识符，如果存在独立观察者；  
  
TG 证据生成的日期与时间；  
  
T2 消息交付的日期与时间；  
  
Q 需要保护的可选数据；  
  
Imp(m) 与动作有关的消息m的印记，即1）m的杂凑码，或2）m本身。  
  
**时间戳令牌**   
  
时间戳令牌TST可由可信时间戳机构使用GB/T 20520中的方法生成。  
  
TTP进行的令牌验证  
  
**验证过程**   
  
在抗抵赖交换过程的某个环节上，可能需要TTP对实体的令牌（如上定义所示）进行验证。在交换完成以后的某个时刻，也可能需要再次验证令牌，或者向第四方提供证据以证明其真实性。  
  
验证过程不仅要检验令牌是否由TTP创建，而且要检验令牌是否与消息的数据字段确切相关。为了验证令牌是否为给定的消息而创建，实体把由消息计算而得的Imp(m)与数据字段z中包括的Imp(m)进行比较，然后要求TTP对令牌及其数据字段进行验证。  
  
为了验证由对称完整性技术生成的安全信封，应进行如下操作：使用实体X的相应秘密密钥x对安全信封中包含的数据y重新计算密码校验值MACX(y)，然后把结果与所提供的密码校验值进行比较。  
  
TTP应使用8.4.2与8.4.3中定义的两种验证方法之一进行验证。  
  
**在线令牌验证**   
  
当使用在线令牌验证方法时，TTP使用包含秘密密钥ttp的安全模块来验证令牌。安全模块将该令牌与使用数据项zi和秘密密钥ttp在其内部生成的值进行比较，并返回比较结果，该结果决定了令牌是否有效。由于密钥ttp不为TTP之外的任何人所知，如果安全模块返回的结果表明该令牌是有效的，那么所验证的令牌也可以认为是真实可信的。  
  
**令牌表**   
  
当使用令牌表方法时，TTP将发布的所有令牌储存在一张表中。对每个已创建的令牌，TTP记录下令牌和相关的数据字段（zi）以及秘密密钥ttp的密钥标识符。要验证一个令牌，TTP把该令牌作为索引在表中进行查找。如果在表中能够找到要验证的令牌，而且该令牌所带的数据字段（即令牌的一部分）与表中对应的数据字段相符，则认为该令牌是真实可信的。  
  

![](http://public.host.github5.com/media/fengmian.png)
# 总结 
 更多内容 可以[ 点击 访问 siduwenku.com 网站的报告 ](https://siduwenku.com/view/list/report?f=2023)进一步学习

# 友情连接
[中央企业投资监督管理暂行办法.pdf](http://github5.com/view/77460?f=new)

[T-ZSSP 0005—2022 方便食品 速食汤、羹.pdf](http://github5.com/view/59424?f=new)

[DB5107-T 82—2020 地理标志产品 天宝蜜柚 绵阳市.pdf](http://github5.com/view/23306?f=new)
