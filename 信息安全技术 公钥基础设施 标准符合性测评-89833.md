# 声明 
本文是学习[信息安全技术 公钥基础设施 标准符合性测评. ](https://siduwenku.com/view/782?f=new_2023)而整理的学习笔记,分享出来希望更多人受益,如果存在侵权请及时联系我们
# 在线证书状态协议测评  
  
## 总则  
  
### 请求  
  
测评依据见GB/T 19713—2005中5.2的内容。  
  
开发者应提供文档，对所使用的在线证书状态协议进行说明。  
  
测评方法如下。  
  
1.  由OCSP请求者发送多个不同状态证书的状态请求，检测OCSP响应器是否提供了正确的证书状态响应；  
2.  检测OCSP请求是否包含以下数据：协议版本、服务请求、目标证书标识符、其他扩展数据（如OCSP请求者的签名、随机数等）；  
3.  使用工具发送不正确报文格式的请求，检测OCSP响应器是否发出错误信息；  
4.  使用工具发送响应器没有配置所要求服务的请求，检测OCSP响应器是否发出错误信息；  
5.  使用工具发送不完整信息的请求，检测OCSP响应器是否发出错误信息。  
  
记录测评结果并对该结果是否完全符合标准相关要求作出判断。如果以上结果全部符合，则本项满足。  
  
### 响应  
  
测评依据见GB/T 19713—2005中5.3的内容。  
  
开发者应提供文档，对响应签名的密钥、响应消息格式、响应消息内容等进行说明。  
  
测评方法如下。  
  
1.  模拟各种身份的OCSP请求者，发送多个不同状态证书的状态请求，OCSP响应请求，检测此过程中是否对所有明确的响应报文都进行数字签名。  
2.  检测响应签名的密钥是否为下列三种情况之一：  
1.  签发待查询证书的CA公钥，  
1.  可信赖的响应器的公钥，  
1.  CA指定的响应器公钥。  
3.  由OCSP请求者发送多个不同状态证书的状态请求，检测OCSP响应器的响应消息中是否包含以下内容：  
1.  响应语法的版本，  
1.  响应器的名称，  
1.  对请求中每个证书的响应，  
2.  可选择的扩展，  
3.  签名算法的OID，  
4.  响应的杂凑值签名。  
4.  检测对请求中每个证书的响应，是否包含以下内容：  
1.  目标证书标识符，  
1.  证书状态值，  
1.  响应的有效期限，  
2.  可选的扩展。  
5.  检测OCSP响应消息中，证书状态值是否为以下三种响应标识符之一，并检测证书状态是否与实际一致：  
1.  Good，表示对状态查询的肯定响应；  
1.  Revoked（已撤销），表示证书已被撤销；  
1.  Unknown（未知），表示响应器不能鉴别待验证状态的证书。  
  
记录测评结果并对该结果是否完全符合标准相关要求作出判断。如果以上结果全部符合，则本项满足。  
  
### 异常情况  
  
测评依据见GB/T 19713—2005中5.4的内容。  
  
开发者应提供文档，对OCSP响应器返回的错误消息进行说明。  
  
测评方法如下。  
  
1.  使用工具发送一个没有遵循OCSP语法的请求，检测OCSP响应器是否发出相应的错误信息；  
2.  使响应器处于非协调的工作状态，发送一个正常请求，检测OCSP响应器是否发出相应的错误信息；  
3.  使响应器处于不能返回所请求证书的状态，发送一个证书请求，检测OCSP响应器是否发出相应的错误信息；  
4.  使用工具发送一个没有签名的请求，检测OCSP响应器是否发出相应的错误信息；  
5.  使用工具发送一个未授权的请求，检测OCSP响应器是否发出相应的错误信息。  
  
记录测评结果并对该结果是否完全符合标准相关要求作出判断。如果以上结果全部符合，则本项满足。  
  
### thisUpdate、nextUpdate和producedAt的语义  
  
测评依据见GB/T 19713—2005中第9章的内容。  
  
开发者应提供文档，对thisUpdate、nextUpdate和producedAt的语义进行说明。  
  
测评方法如下。  
  
1.  发送多个证书请求，检测OCSP响应消息是否包含以下时间字段：  
2.  thisUpdate：此次更新时间；  
3.  nextUpdate（可选字段）：下次更新时间；若没有设置此字段，需指明随时可以获得更新的撤销信息；  
4.  producedAt：签发时间。  
  
记录测评结果并对该结果是否完全符合标准相关要求作出判断。如果以上结果全部符合，则本项满足。  
  
### OCSP签名机构的委托  
  
测评依据见GB/T 19713—2005中5.7的内容。  
  
开发者应提供文档，对所使用的在线证书状态协议中OCSP签名机构的委托过程进行说明。  
  
测评方法如下。  
  
1.  如果签署证书状态信息的密钥与签署证书的密钥不同，由CA向响应器签发一个含有extendedKeyUsage唯一值的证书；  
2.  发送一个证书状态查询请求，检测响应器能否用上述证书对证书状态信息进行签名。  
  
记录测评结果并对该结果是否完全符合标准相关要求作出判断。如果以上结果全部符合，则本项满足。  
  
### CA密钥泄露  
  
测评依据见GB/T 19713—2005中5.8的内容。  
  
开发者应提供文档，对CA密钥泄露时OCSP响应器的设置进行说明。  
  
测评方法如下。  
  
1.  在OCSP响应器中，将某一个CA的状态设置为私钥泄露；  
2.  发送一个上述CA签发的证书状态查询请求，检测OCSP响应器能否返回上述CA签发的所有证书已撤销的状态信息。  
  
记录测评结果并对该结果是否完全符合标准相关要求作出判断。如果以上结果全部符合，则本项满足。  
  
## 安全考虑  
  
测评依据见GB/T 19713—2005中第8章的内容。  
  
开发者应提供文档，对所使用的在线证书状态协议进行脆弱性分析。  
  
测评方法如下。  
  
1.  查看开发者提供的脆弱性分析报告，检测OCSP系统能否抵御标准中的相关攻击（至少应该包括拒绝服务攻击和重放攻击）。  
  
记录测评结果并对该结果是否完全符合标准相关要求作出判断。如果以上结果全部符合，则本项满足。  
  

![](http://public.host.github5.com/media/fengmian.png)
# 延伸阅读 
 更多内容 可以[ 信息安全技术 公钥基础设施 标准符合性测评. ](https://siduwenku.com/view/782?f=2023)进一步学习

# 友情连接
[DB42-T 1925-2022 湖泊湿地干旱与洪涝气象灾害影响调查规范 湖北省.pdf](http://github5.com/view/33978?f=new)

[DB21-T 3055-2018 草原少花蒺藜草防治技术规程 辽宁省.pdf](http://github5.com/view/39806?f=new)

[DB44-T 2322—2021 金毛狗栽培技术规程 广东省.pdf](http://github5.com/view/22247?f=new)
