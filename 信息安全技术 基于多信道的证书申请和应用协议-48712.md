# 声明 
本文是学习[信息安全技术 基于多信道的证书申请和应用协议. ](https://siduwenku.com/view/630?f=new_2023)而整理的学习笔记,分享出来希望更多人受益,如果存在侵权请及时联系我们
# 基于多信道的证书申请和应用协议 应用场景  
  
**用途**   
  
本附录对标准中数字签名与验签协议、文件加解密协议的典型应用场景进行介绍。  
  
**用于身份鉴别的数字签名协议应用场景**   
  
该协议的一种典型应用场景是智能门锁，可用于智能门锁对用户身份进行鉴别。协议开始前用户的公钥信息已在提供身份鉴别服务的业务系统中完成注册，具体流程如下：  
  
1.  用户选择通过智能移动设备进行开锁，智能移动设备通过NFC获取业务系统的网络访问地址URI、RND、SessionID、业务系统描述信息等信息；  
2.  智能移动设备显示步骤a)中获取到的URI及系统描述信息，要求用户进行确认，确认通过后向业务系统发送身份鉴别请求消息；  
3.  业务系统收到身份鉴别请求消息后进行验证，验证通过后打开智能门锁。  
  
*信息内容数字签名协议应用场景*  
  
该协议的一种典型应用场景是对网上交易内容进行签名，具体流程如下：  
  
1.  用户使用智能移动设备扫描二维码，获取提供交易内容业务系统的访问地址URI和访问令牌信息AccessCode；  
2.  智能移动设备通过网络信道向业务系统发送获取交易内容请求消息；  
3.  业务系统通过网络信道向智能移动设备发送交易内容；  
4.  智能移动设备向用户显示签名内容，用户确认对显示内容进行签名后，智能移动设备将内容签名结果通过网络信道发送至业务系统。  
  
*信息内容数字签名验证协议应用场景*  
  
该协议的一种典型应用场景是证件验证，具体流程如下：  
  
1.  用户使用智能移动设备扫描证件二维码，获取与证件验证系统通信方式为NFC以及访问令牌信息AccessCode；  
2.  智能移动设备通过NFC向证件芯片发送证件内容签名验证请求消息；  
3.  证件芯片收到鉴别请求消息后首先验证AccessCode合法性，验证通过后对证件内容进行签名，同证书下载地址或证书一起发送给智能移动设备；  
4.  智能移动设备提取证书或根据下载地址下载证书，验证签名值是否有效。  
  
*文件加密的密钥传输协议应用场景*  
  
该协议的一种典型应用场景是邮件内容加密，协议开始前用户已将接收者的公钥信息导入到智能移动设备中，具体流程如下：  
  
1.  邮件系统发送邮件内容前，生成二维码，用户使用智能移动设备扫描二维码获取邮件系统访问地址URI及通信密钥CommunicationKey；  
2.  智能移动设备产生随机数作为内容加密密钥ContentKey，分别使用通信密钥CommunicationKey和接收者公钥加密内容加密密钥ContentKey，得到密文c1和密文c2，并通过网络信道发送至邮件系统；  
3.  邮件系统接收到数据后解密密文c1得到内容加密密钥ContentKey，并利用ContentKey加密文件，同时将c2、与加密后的文件一起发送至接收者。  
  
*文件解密的密钥传输协议应用场景*  
  
该协议的一种典型应用场景是邮件内容解密，对应A.5邮件内容加密流程，具体流程如下：  
  
1.  接收者点击邮件内容，邮件系统生成二维码，用户使用智能移动设备扫描二维码获取邮件系统访问地址URI及通信密钥CommunicationKey；  
2.  智能移动设备通过网络信道向邮件系统发送文件解密的密钥传输请求消息；  
3.  邮件系统接收到文件解密的密钥传输请求消息后，通过网络信道向智能移动设备发送用接收者公钥对内容加密密钥ContentKey的加密密文c2；  
4.  智能移动设备接收到文件解密的密钥传输响应消息，使用加解密密钥对中的私钥解密c2，得到内容加密密钥ContentKey，并使用通信密钥CommunicationKey加密ContentKey得到密文c1，通过网络信道将c1发送至邮件系统；  
5.  邮件系统接收到c1数据后，解密c1得到内容加密密钥ContentKey，并使用ContentKey解密文件密文，得到文件明文。  
  
**基于多信道的证书申请和应用协议 采用二维码的证书申请协议**   
  
**用途**   
  
本附录给出了证书申请中的一种模式，即近场信道基于二维码的证书申请示例。应用场景为通过手机向证书认证系统申请证书。  
  
**采用二维码的证书申请协议**   
  
采用二维码进行证书申请的具体流程如下：  
  
1.  证书认证系统生成证书申请登记报文ApplyCertificateRegistration对应的二维码：首先对ApplyCertificateRegistration结构体进行DER编码，然后将编码结果通过BASE64转换成可打印的字符串CONTENT，然后加前缀CERT://，系统生成二维码：  
1.  手机通过扫码获取CERT://CONTENT，并解析CONTENT获取证书认证系统生成的证书申请登记报文ApplyCertificateRegistration；  
2.  手机生成随机验证码VerificationCode并展示给用户；  
3.  手机通过网络信道向该URI所在的证书认证系统发送证书申请请求消息；  
4.  证书认证系统接收到手机的请求消息后，显示输入界面，要求用户输入步骤c)中手机所生成的VerificationCode；证书认证系统对手机的证书申请请求消息进行验证，包括验证RND、SessionID是否有效；用户签名公钥验证签名是否正确；厂商ID是否在可信厂商列表中，厂商私钥对RND的签名是否有效。  
5.  证书认证系统通过网络信道向手机回复证书申请响应消息；  
6.  用户可按照GM/T 0014-2012标准要求下载证书，也可通过近场信道获取证书下载消息。证书下载二维码的TAG为DOWNLOAD，URI为证书下载服务的地址  
  
# 基于多信道的证书申请和应用协议 兼容性分析  
  
1.  **用途**   
  
本附录主要分析本标准定义协议与现有应用协议的兼容性。  
  
1.  **兼容性分析**   
  
目前二维码携带的信息通常为一个URI，URI的格式为：[scheme:][//authority][path][?query]，可以通过scheme来区分不同用途的二维码。本标准中二维码的内容也采用了URI格式，使用TAG作为scheme区分不同的应用场景，具体为：  
  
1.  TAG为CERT，按照第5节协议进行证书申请；  
2.  TAG为AUTH，按照第6.1.1节协议进行身份鉴别；  
3.  TAG为SIGN，按照第6.1.2节协议进行信息内容数字签名；  
4.  TAG为AVERIFY，按照第6.2.1节协议进行身份鉴别的数字签名验证；  
5.  TAG为CVERIFY，按照第6.2.2节协议进行信息内容数字签名验证；  
6.  TAG为ENCRYPT，按照第7.1节协议进行文件加密；  
7.  TAG为DECRYPT，按照第7.2节协议进行文件解密。  

![](http://public.host.github5.com/media/fengmian.png)
# 延伸阅读 
 更多内容 可以[ 信息安全技术 基于多信道的证书申请和应用协议. ](https://siduwenku.com/view/630?f=2023)进一步学习

# 友情连接
[DB35-T 1399-2013 农村五保供养服务机构等级划分与评定 福建省.pdf](http://github5.com/view/47875?f=new)

[海南省社会保障卡一卡通服务管理条例.pdf](http://github5.com/view/79037?f=new)

[DB34-T 2962-2017 胡萝卜种子生产技术规程 安徽省.pdf](http://github5.com/view/36357?f=new)
