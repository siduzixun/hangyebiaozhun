# 声明 
本文是学习[github5.com 网站的报告](https://siduwenku.com/view/list/report?f=first)而整理的学习笔记,分享出来希望更多人受益,如果存在侵权请及时联系我们
# 密钥管理采用非对称技术的机制 要求  
  
本部分要求所涉及的实体彼此知道其所声称的身份，这可通过两个实体间信息交换时所包含的标识符来实现，或从该机制所使用的上下文明显看出。身份验证意味着检查一个收到的标识符与某个已知的（可信的）或预期值是否相同。本部分所规范的机制的对象标识符按附录A。  
  
如果一个公钥属于某实体，那么该实体须确保它拥有相应的私钥（密钥注册见GB/T 17901.1-AAAA）。  
  
本部分中凡涉及到采用密码技术解决机密性、完整性、真实性、不可否认性需求的须遵循密码相关国家标准和行业标准。其中，涉及使用椭圆曲线签名验证、公钥加解密的算法按GB/T 32918.2和GB/T 32918.4。  
  
# 密钥派生函数  
  
对于对称密码系统，不推荐使用由第10章派生的共享秘密而不做任何的进一步处理。通过密钥派生函数可导出共享密钥，建议使用一个单向函数作为密钥派生函数，譬如使用杂凑函数。  
  
密钥派生函数产生的密钥与随机产生的密钥很难区分。但密钥派生函数需输入一个共享秘密和一组密钥派生参数，并产生输出所需长度的密钥。  
  
为了让参与同一个密钥建立机制的双方能够协商出共同的密钥，密钥派生函数应事先商定。达成这一协定的方法超出了本部分的范围。  
  
参见附录C密钥派生函数实例。  
  
# 余子式乘法  
  
本章只适用使用椭圆曲线密码算法的机制。第11章描述的密钥协商机制和第12、13章描述的密钥传送机制都要求用户的私钥或者密钥权标和另一个实体的公钥或者密钥权标混合使用。在椭圆曲线密码算法中，如果另一个实体的公钥或者密钥权标不是有效的（即它不是椭圆曲线上的一个点，或者不在n阶子群中），那么该操作的执行可能会导致私钥中的某些位泄露给攻击者，例如，“小子群攻击”。  
  
有两种选择方法，可防止“小子群攻击”和类似的攻击：  
  
一种方法是采用公钥鉴别法对从另一方接收到的公钥和密钥权标进行验证（见本标准的规定）。另一种方法是采用余子式乘法对公钥进行验证，余子式乘法将在第11章中具体规范。下面定义的*j*和*l*的值，将在余子式乘法中用到。  
  
使用余子式乘法时有两种选择：  
  
1.  如果不要求与未使用余子式相乘的实体兼容，则设*j*=*\#E/n*和*l*=1。在这种情况下，要求参与双方都应同意使用该选项，否则该机制不起作用；  
2.  如果要求与未使用余子式相乘的实体兼容，则设*j*=*\#E*/*n*和*l* =*j*-1mod*n*。  
  
注：由于要求 ，因此*gcd*(*n,j*)=1，所以*j-*1*modn*的值始终存在。  
  
如果不需要用到余子式相乘，则*j*=*l*=1。  
  
无论是否使用了余子式相乘法，如果共享密钥（或者共享密钥的一个组成部分）的计算结果为无穷远点（*OE*），则用户认为密钥协商过程失败。  
  
公钥验证法或余子式乘法特别适合下列情况：  
  
1.  实体的公钥未经验证；  
2.  密钥权标未经验证；  
3.  用户的公钥希望长期使用。  
  
如果另一实体的公钥已被验证且余子式较小，可被泄露的信息相当有限，则可不需完成这些测试。  
  
# 密钥承诺  
  
通过对秘密的密钥协商协议的密钥进行单向函数来建立密钥的机制在第11章描述。然而，某实体可能在选择自己的私钥前就知道另一实体的公钥或密钥权标。所以，在该实体发现其它实体的公钥和选定自己私钥的间隔内，可以以生成2*s*个私钥协商密钥候选值为代价，控制其所要建立的密钥中*s*个二进制比特位的值。  
  
解决问题的方法是使用密钥承诺，这需要在协议中增加一个附加信息或协议交互来。密钥承诺的执行可以通过让第一实体对自己的公钥或者密钥权标进行杂凑变换并将杂凑码送给第二实体；第二实体接着回复自己的公钥或者密钥权标，然后第一实体回复自己的公钥或者密钥权标给第二实体，第二个实体可对它进行杂凑变换并验证杂凑码是否等于之前第一实体所发送的值。  
  
# 密钥确认  
  
显式密钥确认过程是通过添加附加消息到一个提供隐式密钥鉴别的密钥建立协议中，因此提供了显式密钥鉴别和实体鉴别。显式密钥确认可以被添加到任何不包含它本身的方法中。密钥确认通常是通过交换一个值来实现，这个值在很大的概率下只有密钥建立计算成功时才能正确计算出来。从实体*A*到实体*B*的密钥确认是通过实体*A*计算一个值并发送给实体*B*以确认实体*A*的计算。如果要求相互密钥确认，则每个实体需发送一个不同的值给对方。  
  
隐式密钥确认是在已建立的密钥的后续使用中提供密钥确认，当发生某种错误时，就立即检测到。在这种情况下，不需显式密钥确认。如果一个实体不在线（如在单轮通信协议中，存储和转发（电子邮件）的场景），另一个实体就不可能获得密钥确认。然而，有时建立的密钥在后来才使用，或者密钥建立过程的实体并不知道所产生的密钥是否会被立即使用。在这些情况下，通常需使用显式密钥确认方法，否则一旦错误检测出来纠正它就可能太晚。显式密钥确认可看作是密钥建立过程中具有“坚固”安全属性的一种方式，且可认作为是一个保守的协议设计。  
  
使用MAC提供密钥确认的步骤如下：  
  
实体*A*和*B*首先执行本规范中第11及12章中采用的其中一个密钥建立过程，期望共享一个的MAC密钥*KAB*，执行的步骤如下：  
  
1.  实体*B*产生一个八位位组串的消息*M*，包括：消息标识符八位位组0x02，实体*B*的标识符，实体*A*的标识符，对应于实体*B*的密钥权标的八位位组串*KTB*（如不存在，省略），对应于实体*A*的密钥权标的八位位组串*KTA*（如不存在，省略），对应于实体*B*的密钥建立公钥*pB*（如不存在，省略），对应于实体*A*的密钥建立公钥*pA*（如不存在，省略），及可选的附加文本Text1（如存在的话），即：*M*=02\|\|B\|\|A\|\|*KTB*\|\|*KTA*\|\|*pB*\|\|*pA*\|\|Text1，其中0x02是消息序号；  
2.  实体*B*计算*KB*=kdf(*KAB*)，采用共享密钥*KB*，用一个合适的MAC机制对消息*M*计算出MAC*KB*![](http://public.host.github5.com/media/b9e0dcef8f6b359502601f879cf4b875.emf)（*M）*；  
3.  实体*B*将消息*M*和MAC*KB*![](http://public.host.github5.com/media/b9e0dcef8f6b359502601f879cf4b875.emf)（*M*）发送给实体*A*；  
4.  实体*A*计算*KA*=kdf(*KAB*)，用收到的消息*M*计算MAC*KA*![](http://public.host.github5.com/media/dba430991f1c6730d25ec4228858825f.emf)（*M*），并验证MAC*KB*（*M*）=MAC*KA*![](http://public.host.github5.com/media/dba430991f1c6730d25ec4228858825f.emf)（*M*）；  
5.  假设MAC验证，实体*A*已收到实体*B*的密钥确认（即实体*A*知道*KA*=*KB*）。如需相互密钥确认，则实体*A*继续执行协议，产生八位位组串的消息*M* '，由几部分组成：消息标识符八位位组0x03，实体*A*的标识符，实体*B*的标识符，对应于实体*A*的密钥权标的八位位组串*KTA*（如不存在，省略），对应于实体*B*的密钥权标的八位位组串*KTB*（如不存在，省略），对应于实体*A*的密钥建立公钥*pA*（如不存在，省略），对应于实体*B*的密钥建立公钥*pB*（如不存在，省略），以及可选的附加文本Text2（如存在的话），即：*M* '=03\|\|A\|\|B\|\|*KTA*\|\|*KTB*\|\|*pA*\|\|*pB*\|\|Text2，其中0x03是消息序号；  
6.  实体*A*采用共享密钥*KA*，用一个合适的MAC机制计算MAC*KA*![](http://public.host.github5.com/media/dba430991f1c6730d25ec4228858825f.emf)（ *M* '）；  
7.  实体*A*将*M* '和MAC*KA*![](http://public.host.github5.com/media/dba430991f1c6730d25ec4228858825f.emf)（ *M* '*）*发送给实体*B*；  
8.  对消息*M* '，实体*B用KB*验证MAC*KA*![](http://public.host.github5.com/media/dba430991f1c6730d25ec4228858825f.emf)（ *M* '）。假设MAC验证，实体*B*已收到实体*A*的密钥确认（即实体*B*知道*KA=KB*）。  
  
也可采用其它确认密钥方法，如果共享密钥用于数据加密，那么一实体可将另一实体已知的一些特定的明文进行加密，并发送给该实体，如全0或全1的二进制块，但应注意后续使用该密钥时，不再加密用于密钥确认时使用过的同一明文。  
  

![](http://public.host.github5.com/media/fengmian.png)
# 总结 
 更多内容 可以[ 点击 访问 siduwenku.com 网站的报告 ](https://siduwenku.com/view/list/report?f=2023)进一步学习

# 友情连接
[DB1410-T 124-2020 玉米主要病虫草害防治技术规程 临汾市.pdf](http://github5.com/view/26452?f=new)

[志愿服务记录与证明出具办法 试行.pdf](http://github5.com/view/77106?f=new)

[DB15-T 961-2016 医药物流信息管理规范 内蒙古自治区.pdf](http://github5.com/view/44964?f=new)
